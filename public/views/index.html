<html>
<head>
  <title>My Canvas App</title>
  <!-- stylesheet -->
  <link rel="stylesheet" type="text/css" href="https://necolas.github.io/normalize.css/3.0.2/normalize.css">
</head>
<body>
  <h3>Please select the product related to this case</h3>
 <button id='link'>Click Me</button>
    <script src="https://ajax.deskapi.com/libs/desk/canvas/1.0.0/desk-canvas-all.js"></script>
   <script>
     var oLink = document.getElementById('link');
     oLink.addEventListener('click', postArticle);
        
     function postArticle() {
        var sr = Desk.canvas;
        var url = sr.client.instanceurl +"/articles";
        var reply_url = sr.context.environment.case.url+"/replies";
       
        Desk.canvas.client.ajax(reply_url, 
          {client:sr.client,
          success: function(data) {
          if (200 === data.status) {
            var reply_data = data.body;
          } else {
            alert("get reply failed");
          };
          }
        });
     
       var body = {body: reply_data, subject: "test",
         _links: {
           topic: {
             href: "/api/v2/topics/642669",
             class: "topic"
         }
       }};
     
       Desk.canvas.client.ajax(url,
         {client : sr.client,
           method: 'POST',
           data: JSON.stringify(body),
           success : function(data) {
           if (201 === data.status) {
             alert("Success");
           } else {
            alert("get article failed");
         }
         }
       });
     }
   </script>

</body>
</html>
